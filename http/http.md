# HTTP 协议总结

## HTTP 0.9

http 0.9协议基于tcp协议的应用层协议，0.9版本非常简单，只支持GET，
主要用于从服务器获取HTML文件，每次请求都创立一个tcp连接，请求后断开。

## HTTP 1.0

http 1.0 相比0.9增加:
+ HTTP 响应码
+ HEAD POST等方法
+ HEADER

### HTTP 1.0缺点
+ 每次请求都需要创建连接与断开

## HTTP 1.1 

http 1.1是使用最广泛的http协议，协议标准是99年定义。
相比1.0 主要增加:
+ 连接管理
+ 状态码，头定义
+ 条件请求
+ 断点续传
+ 鉴权
+ 缓存
+ 分块传输

http1.0协议连接最大的缺点， 每次请求都需要创建断开tcp连接，tcp的创建需要经历3次握手
，传输过程需要经历慢启动，而3次握手与慢启动都很耗性能。基于此1.1默认打开keepalive
不关闭这个tcp连接，打开keepalive后，可以通过一个tcp连接发送多次http请求。http是请求-响应
一个tcp连接发送请求后需要等待服务端返回才能发送下次请求。这种阻塞请求方式限制吞吐。未来避免
阻塞方式带来的吞吐问题，1.1 还规范了pipeline机制。

### HTTP 1.1 pipeline

pipeline机制允许在返回之前直接发送下一个请求。pipeline机制是把客户端的FIFO转移到服务端。

### HTTP1.1缺点
+ pipeline 对头阻塞问题

## HTTP 2.0

相比1.1主要变化:
+ 连接多路复用
+ 头部压缩
+ 服务端推送

### 连接多路复用
2.0 相比1.1 最大的改进是在应用层使用多路复用，增加stream的概念，通过stream细化FIFO队列，同一个stream需要
满足FIFO，不同的stream可以并发请求响应。



### HTTP2 缺点
+ tcp协议传输层的阻塞

## HTTP 3.0

相比2.0 主要的变化:
+ 传输协议改udp
+ 重新实现重传机制保证可靠
+ 重新实现拥塞算法
+ 前向纠错 FEC（冗余换取纠错）
+ Packet Number（解决sq无法区分重传与发送包 影响rtt计算问题）
+ ACK Delay（解决tcp协议无法精确计算rtt）

### UDP的可靠性

http3 传输协议从tcp改成udp，主要解决问题:
+ tcp协议性能问题（握手需要1.5rtt等）
+ tcp协议的对头阻塞问题（需要等待包重组）
+ tcp在内核实现，很难针对升级（相当于把拥塞，可靠性转移到应用层做更灵活）

udp相比tcp一个是面向连接端到端可靠协议，一个是面向数据包传输协议。
所以udp作为底层传输协议需要在应用层面实现可靠性，流控，拥塞控制。

我们先看tcp如何实现的可靠性:
+ 3次握手确定连接
+ 重传机制（超时重传， SACK重传）
+ 消息确认机制

kcp协议就是一个基于udp实现可靠性的应用协议，
kcp实现可靠性:
+ conv 连接号，表示虚拟连接
+ 流控与拥塞与tcp一致

## HTTPS

### TLS 1.2 vs 1.3

http协议本身是明文传输，为了安全需要进行数据加密，http协议上封装一层TLS协议就成了加密的https，

TLS 1.2 握手过程




## 参考资料

https://zhuanlan.zhihu.com/p/143464334